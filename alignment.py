## Paul to write up the code for the alignment, in 1D or in 2D maybe with a flag